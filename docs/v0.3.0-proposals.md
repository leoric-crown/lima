# LIMA v0.3.0 Proposals

> Discovery Session Output â€” December 2025
>
> Generated through multi-agent brainstorming with n8n workflow architects, local-first AI researchers, and creative technologists.

---

## Executive Summary

**The Vision:** Transform LIMA from a file-drop workflow into a **complete voice-to-knowledge application** â€” a single web page that lets you record, process, query, and browse your voice memos, all served by n8n with zero external dependencies.

**The Flagship Feature:** *Voice Recorder UI* â€” A beautiful, mobile-friendly web interface served directly by n8n that captures audio, shows live processing status, and displays results inline.

**Why This Matters:**
- **Zero friction** â€” No file management, just click and talk
- **Self-contained demo** â€” One URL does everything (n8n serves UI AND processes audio)
- **Mobile-friendly** â€” Works from phone browser via Tailscale, no app needed
- **Full-stack showcase** â€” Proves n8n can be a complete application platform, not just backend automation
- **Viral demo potential** â€” "Record a question, watch AI answer it in real-time"

---

## The Flagship Feature: Voice Recorder UI

### The Experience

```
Open: http://lima.tailnet:5678/webhook/recorder
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚                      ğŸ™ï¸ LIMA                            â”‚
â”‚              Your Local AI Memory                       â”‚
â”‚                                                         â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                  â”‚  âº REC  â”‚  â† Big red button          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                         â”‚
â”‚              Recording: 0:12 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘               â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Processing...                                          â”‚
â”‚  âœ“ Audio received (847 KB)                              â”‚
â”‚  âœ“ Transcription complete (127 words)                   â”‚
â”‚  âŸ³ Extracting insights...                              â”‚
â”‚  â—‹ Writing note...                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  ğŸ“„ Generated Note Preview                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  # Team Standup Notes                                   â”‚
â”‚  **Date:** 2024-12-10                                   â”‚
â”‚  **Participants:** Sarah, Mike, Alex                    â”‚
â”‚                                                         â”‚
â”‚  ## Action Items                                        â”‚
â”‚  - [ ] Review API spec (@sarah)                         â”‚
â”‚  - [ ] Update tests (@mike)                             â”‚
â”‚                                                         â”‚
â”‚  [Open in Obsidian] [View All Notes]                    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Why This Changes Everything

| Before (v0.2.0) | After (v0.3.0) |
|-----------------|----------------|
| Record on phone â†’ Transfer file â†’ Drop in folder â†’ Check n8n â†’ Open Obsidian | Open URL â†’ Click record â†’ Watch magic happen â†’ Done |
| 5+ steps, multiple apps | 1 step, one interface |
| No feedback during processing | Live status updates |
| Desktop-only workflow | Mobile-first, works anywhere |
| "Cool automation project" | "This is an actual product" |

### Technical Implementation

#### Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     n8n Webhooks                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  GET /webhook/recorder                                       â”‚
â”‚  â””â”€â†’ Serves static HTML (recorder UI)                        â”‚
â”‚                                                              â”‚
â”‚  POST /webhook/recorder/upload                               â”‚
â”‚  â””â”€â†’ Receives audio blob                                     â”‚
â”‚  â””â”€â†’ Returns processing_id                                   â”‚
â”‚  â””â”€â†’ Triggers async processing workflow                      â”‚
â”‚                                                              â”‚
â”‚  GET /webhook/recorder/status/:id                            â”‚
â”‚  â””â”€â†’ Returns processing status JSON                          â”‚
â”‚  â””â”€â†’ { stage: "transcribing", progress: 45, transcript: "..."}â”‚
â”‚                                                              â”‚
â”‚  GET /webhook/recorder/notes                                 â”‚
â”‚  â””â”€â†’ Returns recent notes list                               â”‚
â”‚  â””â”€â†’ For "View All Notes" panel                              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### The HTML Page (Self-Contained)

Single HTML file with embedded CSS/JS â€” no build step required:

```html
<!-- Served by n8n webhook, ~500 lines total -->
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>LIMA Voice Recorder</title>
  <!-- Tailwind via CDN for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen">

  <!-- Recording Interface -->
  <div id="recorder">
    <button id="record-btn">ğŸ™ï¸ Hold to Record</button>
    <div id="timer">0:00</div>
    <canvas id="waveform"></canvas>
  </div>

  <!-- Processing Status -->
  <div id="status" class="hidden">
    <div id="stages"><!-- Populated by JS --></div>
    <div id="progress-bar"></div>
  </div>

  <!-- Result Preview -->
  <div id="result" class="hidden">
    <div id="note-preview"><!-- Rendered markdown --></div>
    <a id="obsidian-link">Open in Obsidian</a>
  </div>

  <!-- Recent Notes Sidebar -->
  <div id="notes-list"><!-- From /notes endpoint --></div>

  <script>
    // MediaRecorder API for audio capture
    // Polls /status/:id every 500ms during processing
    // Renders markdown preview with marked.js
    // obsidian:// URI scheme for deep linking
  </script>
</body>
</html>
```

#### Key Browser APIs Used

| API | Purpose |
|-----|---------|
| `MediaRecorder` | Capture audio from microphone |
| `AudioContext` | Waveform visualization |
| `fetch` | Upload audio, poll status |
| `marked.js` | Render markdown preview (CDN) |

#### Workflow Modifications

**New: `voice-recorder-ui` workflow**
- Webhook node serves HTML on GET
- Returns static HTML string (no external files needed)

**Modified: `voice-memo-processor` workflow**
- Add `processing_id` generation at start
- Store status in PostgreSQL `processing_log` table
- Update status at each stage (received â†’ transcribing â†’ extracting â†’ writing â†’ complete)
- Return structured JSON instead of just writing file

**New: `recorder-status` workflow**
- Webhook returns current status for given processing_id
- Includes partial results (transcript preview, extracted fields)

### Mobile-First Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ğŸ™ï¸ LIMA        â”‚  â† Centered logo
â”‚                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚           â”‚    â”‚
â”‚    â”‚    âº      â”‚    â”‚  â† Large touch target (80x80px minimum)
â”‚    â”‚           â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â”‚
â”‚    Tap to record    â”‚
â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Recent Notes        â”‚  â† Collapsible on mobile
â”‚ â€¢ Team standup...   â”‚
â”‚ â€¢ Project idea...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Mobile considerations:**
- Touch-friendly buttons (minimum 44px)
- Works in portrait and landscape
- iOS Safari MediaRecorder support (iOS 14.3+)
- Responsive breakpoints for tablet/desktop

### The Viral Demo

**"From Voice to AI Answer in 30 Seconds":**

1. Open `http://lima.local:5678/webhook/recorder` on phone
2. Tap the big red button
3. Say: "What did I discuss with Sarah about the budget last week?"
4. Watch live: transcription appears â†’ "Searching notes..." â†’ Answer renders
5. See: AI-generated answer with [[wikilinks]] to source notes
6. Click: Opens directly in Obsidian mobile app

**Why it goes viral:**
- One URL, zero setup for the viewer
- Works on their phone right now (if they have LIMA)
- Visual feedback makes the "magic" tangible
- Proves local AI can match cloud UX

---

## Pillar 2: Conversational Memory Query

**Elevator Pitch:** "Ask your notes questions and get answers with citations."

This feature powers the "question mode" of the Voice Recorder UI:

```
User records: "What did I decide about the API integration?"
                    â†“
LIMA detects question-style memo (starts with what/when/how/why)
                    â†“
Generates embedding for the question
                    â†“
Searches note_embeddings via pgvector (cosine similarity)
                    â†“
Feeds top 5 chunks to LLM: "Answer this using these sources"
                    â†“
Returns answer with [[wikilinks]] to source notes
```

### Technical Implementation

**Database additions:**
```sql
CREATE TABLE note_embeddings (
    id SERIAL PRIMARY KEY,
    note_path TEXT NOT NULL,
    content_hash TEXT NOT NULL,
    chunk_index INTEGER DEFAULT 0,
    chunk_text TEXT,
    embedding vector(768),  -- nomic-embed-text dimension
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX note_embeddings_idx
ON note_embeddings USING ivfflat (embedding vector_cosine_ops);
```

**New workflows:**
| Workflow | Trigger | Function |
|----------|---------|----------|
| `embed-notes` | Schedule + Manual | Batch embed all existing notes |
| `embed-single-note` | After note creation | Index new notes automatically |
| `query-processor` | Question detection | RAG search + answer synthesis |

**Embedding strategy:**
- Model: `nomic-embed-text` via Ollama (768 dimensions, fast, local)
- Chunking: 500 tokens with 100 token overlap
- Preserve markdown structure (don't split mid-heading)

---

## Pillar 3: Context-Aware Routing

**Elevator Pitch:** "Different memos, different workflows, automatic detection."

The Voice Recorder UI routes memos to specialized processing:

| Detection | Route | Output |
|-----------|-------|--------|
| Starts with "I met with..." | Meeting Notes | Participants, decisions, action items |
| Starts with "Idea:..." | Idea Capture | Related notes, innovation tags |
| Starts with "Remember to..." | Quick Todo | Checkbox note, optional reminder |
| Starts with "Question:..." | Memory Query | Semantic search + RAG answer |
| Default | Standard Memo | Current v0.2.0 extraction |

**Implementation:**
- Quick LLM classification call (~100ms with small local model)
- n8n Switch node routes to sub-workflows
- Each sub-workflow has specialized prompts + output templates

---

## Pillar 4: Robustness & Reliability

### Context Overflow Handling

```
Long Transcript (>8k tokens)
        â†“
Split into chunks with 30% overlap
        â†“
Summarize each chunk independently
        â†“
Synthesize chunk summaries into final output
```

### Error Handling

```
Processing Failed
        â†“
Update status to "failed" with error message
        â†“
UI shows error with retry button
        â†“
Move source to voice-memos/failed/
        â†“
Create {filename}.error.json sidecar
```

### Graceful Degradation

```
Whisper (base) â†’ FAILS â†’ Whisper (tiny) â†’ FAILS â†’ Show manual transcription input
```

---

## Implementation Phases

### Phase 1: Voice Recorder UI (Week 1)
- [ ] Create `voice-recorder-ui` webhook workflow
- [ ] Build HTML page with MediaRecorder integration
- [ ] Add `processing_log` table for status tracking
- [ ] Implement status polling endpoint
- [ ] Test on mobile (iOS Safari, Android Chrome)

### Phase 2: Live Processing Feedback (Week 1-2)
- [ ] Modify `voice-memo-processor` to update status at each stage
- [ ] Add transcript preview to status response
- [ ] Implement progress percentage calculation
- [ ] Add waveform visualization during recording

### Phase 3: Memory Query System (Week 2-3)
- [ ] Add `note_embeddings` table
- [ ] Create `embed-notes` batch workflow
- [ ] Implement question detection
- [ ] Build RAG query pipeline
- [ ] Integrate with recorder UI (show answers inline)

### Phase 4: Routing & Polish (Week 3-4)
- [ ] Create `smart-router` classification
- [ ] Build specialized sub-workflows (meeting notes, ideas)
- [ ] Add "Recent Notes" panel to UI
- [ ] Implement Obsidian deep links
- [ ] Error handling and edge cases
- [ ] Documentation

---

## Technical Architecture

### New Workflows

| Workflow | Trigger | Function |
|----------|---------|----------|
| `voice-recorder-ui` | GET webhook | Serve HTML page |
| `recorder-upload` | POST webhook | Receive audio, start processing |
| `recorder-status` | GET webhook | Return processing status |
| `recorder-notes` | GET webhook | Return recent notes list |
| `embed-notes` | Schedule/Manual | Batch embed notes |
| `query-processor` | Internal call | RAG search + synthesis |
| `smart-router` | Internal call | Classify and route memos |

### Database Schema Additions

```sql
-- Processing status tracking
CREATE TABLE processing_log (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    source_filename TEXT,
    status TEXT NOT NULL DEFAULT 'pending',
    stage TEXT,  -- 'received', 'transcribing', 'extracting', 'writing', 'complete', 'failed'
    progress INTEGER DEFAULT 0,
    transcript TEXT,
    result_path TEXT,
    error_message TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Vector embeddings for semantic search
CREATE TABLE note_embeddings (
    id SERIAL PRIMARY KEY,
    note_path TEXT NOT NULL,
    content_hash TEXT NOT NULL,
    chunk_index INTEGER DEFAULT 0,
    chunk_text TEXT,
    embedding vector(768),
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX note_embeddings_idx
ON note_embeddings USING ivfflat (embedding vector_cosine_ops);
```

---

## The Local-First Advantage

| Feature | Cloud Alternative | LIMA Advantage |
|---------|------------------|----------------|
| Voice recording | Otter.ai, Whisper API | No upload to external servers |
| AI extraction | ChatGPT, Claude | Your prompts stay private |
| Note storage | Notion, Roam | Plain markdown, you own it |
| Search | Algolia, Elastic | pgvector, runs on your hardware |
| Mobile access | Cloud sync | Tailscale, encrypted tunnel |

**The pitch:** "The UX of a cloud app, the privacy of local-first, the extensibility of n8n."

---

## Future Enhancements (v0.4.0+)

### Multi-Speaker Diarization
- pyannote-audio integration
- Speaker labels in transcript
- Per-speaker insights

### Home Assistant Integration
- Voice commands trigger automations
- "Remind me when I get home"

### Collaborative Mode
- Share recorder URL with team
- Multiple users, one LIMA instance
- Per-user note folders

### Offline Recording
- Service worker caches UI
- IndexedDB queues recordings
- Sync when connection restored

---

## Appendix: Research Sources

### n8n Capabilities
- [RAG in n8n | n8n Docs](https://docs.n8n.io/advanced-ai/rag-in-n8n/)
- [Building RAG in 2025: Vector Stores as Tools](https://community.n8n.io/t/building-rag-in-2025-vector-stores-as-tools-is-here/75166)
- [PGVector Vector Store node](https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstorepgvector/)

### Local-First AI
- [Local AI Agents: Privacy-First Alternative](https://gloriumtech.com/local-ai-agents-the-privacy-first-alternative-to-cloud-based-ai/)
- [Local-First Software Manifesto](https://www.inkandswitch.com/essay/local-first/)

### Browser Audio APIs
- [MediaRecorder API - MDN](https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder)
- [Web Audio API - MDN](https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API)

---

*Generated by LIMA Discovery Session â€” Opus 4.5 + Multi-Agent Brainstorming*
*Updated with Voice Recorder UI as flagship feature*
